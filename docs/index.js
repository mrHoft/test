"use strict";(self.webpackChunknonograms=self.webpackChunknonograms||[]).push([[826],{7:()=>{class e{static _instance;themeName="light";colors={color00:" #fff",color20:"#c8c8c8",color100:"#000"};callback=()=>{};constructor(){if(e._instance)return e._instance;e._instance=this}addCallback(e=(()=>{})){this.callback=e}emit(){this.callback()}get name(){return this.themeName}set name(e){this.themeName=e,this.emit()}get color00(){return this.colors.color00}get color100(){return this.colors.color100}set color00(e){this.colors.color00=e}set color100(e){this.colors.color100=e}}const t={size:600,size20deg:723.7723388671875,blockSize:30,spf:16,modes:["5x5","10x10","15x15"],languages:["en","ru"]},n={dot:{url:"./public/dot.ogg",type:"multiple"},cross:{url:"./public/cross.ogg",type:"multiple"},whoosh:{url:"./public/whoosh01.ogg"},slide:{url:"./public/whoosh02.ogg"},step:{url:"./public/step.ogg",type:"multiple"}},a=[{name:"Intro",url:"./public/track01.ogg"},{name:"Tool In Space",url:"./public/track02.ogg"},{name:"Inside The Bucket",url:"./public/track03.ogg"}],s={win:["./public/win01.ogg"],loose:["./public/loose01.ogg","./public/loose02.ogg","./public/loose03.ogg","./public/loose04.ogg","./public/loose05.ogg"]},o=Object.keys(n).length+2*a.length+Object.values(s).reduce(((e,t)=>e+t.length),0);class c{static _instance;sound={volume:.5,muted:!1};music={volume:.25,muted:!0};sounds={};tracks=[];speech={win:[],loose:[]};_loaded=0;ready=0;_pending=null;_playing=null;readyCallback=()=>{};startPlayCallback=()=>{};exceptionCallback=()=>{};constructor(){if(c._instance)return c._instance;c._instance=this,Object.keys(s).forEach((e=>s[e].forEach((t=>this._getSound(t,e,"speech"))))),Object.keys(n).forEach((e=>this._getSound(n[e].url,e,n[e].type))),a.forEach((e=>this._getSound(e.url,e.name,"music"))),this._canplay=this._canplay.bind(this),this._ended=this._ended.bind(this)}set musicVolume(e){this.music.volume=e,this._playing&&(this._playing.audio.volume=e)}set musicMuted(e){this.music.muted=e,this._playing?this._playing.audio.muted=e:this.play(0,1)}play(e,t){if(this.music.muted)return;if(!this.tracks[e]||!this.tracks[e].ready)return console.log(`Pending music: ${e}. ${this.tracks[e]?this.tracks[e].name:""}`),void(this._pending=e);const n=this.tracks[e].audio;n.volume=this.music.volume,n.muted=this.music.muted,n.play().then((()=>{t&&n.addEventListener("ended",this._ended),this._playing={track:e,audio:n},this.startPlayCallback(this.tracks[e].name)})).catch((e=>{console.warn(e),this.music.muted=!0,this.exceptionCallback()}))}use(e){if(!this.sound.muted)if(this.sounds[e])for(let t=0;t<10;t+=1){const n=this.sounds[e][t];if(0===n.currentTime||n.ended)return n.volume=this.sound.volume,void n.play().catch((e=>console.log(e)))}else console.warn(`No sound: ${e}`)}say(e){if(this.sound.muted)return;if(!this.speech[e])return void console.warn(`No speech: ${e}`);const t=this.speech[e][~~(Math.random()*this.speech[e].length)];t.volume=this.sound.volume,t.play().catch((e=>console.log(e)))}_getSound(e,t,n=0){const a=this,s=new Request(e,{method:"GET",headers:{"Accept-Ranges":"1000000000"},referrerPolicy:"no-referrer"});fetch(s).then((e=>e)).then((async function(e){const s=await e.blob(),c=window.URL.createObjectURL(s);if(a._loaded+=1,a.ready=~~(a._loaded/o*100),"speech"===n){const e=new Audio;e.src=c,a.speech[t].push(e)}else if("music"===n){const e=new Audio;e.src=c,e.localInfo={name:t,track:a.tracks.length},e.addEventListener("canplay",a._canplay),a.tracks.push({audio:e,name:t})}else a.sounds[t]=Array.from({length:"multiple"===n?10:1},(()=>{const e=new Audio;return e.src=c,e}));a.readyCallback(a.ready,t)}))}_canplay(e){e.target.removeEventListener("canplay",this._canplay);const{name:t,track:n}=e.target.localInfo;this._loaded+=1,this.ready=~~(this._loaded/o*100),this.tracks[n].ready=!0,this._pending===n&&(this.play(this._pending,1),this._pending=null),this.readyCallback(this.ready,t)}_ended(){if(!this._playing)return;let e=(this._playing.track??0)+1;e>=this.tracks.length&&(e=0),this._playing=null,this.play(e,1)}}const r={theme:(()=>{let e="light";return"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),e})(),lang:(()=>{let e="en";return navigator?.language&&(e=navigator.language.slice(0,2)),t.languages.includes(e)||(e="en"),e})(),sound:{volume:.5,muted:!1},music:{volume:.3,muted:!0},records:[],puzzles:[],last:{game:null,editor:null}};class l{static STORE_NAME="Nonograms";static _instance;_state={};constructor(){if(l._instance)return l._instance;const e=localStorage.getItem(l.STORE_NAME);this._state=JSON.parse(e)??r,l._instance=this}getState(){return this._state}removeState(){this._state={},this.emit()}get(e){return m(this._state,e)}set(e,t){d(this._state,e,t),this.emit()}add(e,t){const n=m(this._state,e);if(void 0===n)d(this._state,e,[t]);else{if(!Array.isArray(n))throw new Error(`Can not add to ${e}`);n.push(t)}this.emit()}emit(){localStorage.setItem(l.STORE_NAME,JSON.stringify(this._state))}}function d(e,t,n){if(e!==Object(e))return e;if("string"!=typeof t||""===t)throw new Error("App store. Path must be type of string.");let a=e;const s=t.split("."),o=s.pop();return s.forEach((e=>{a[e]||(a[e]={}),a=a[e]})),o&&(a[o]=n),e}function m(e,t){if(e===Object(e)&&"string"==typeof t&&""!==t)return t.split(".").reduce(((e,t)=>void 0!==e[t]?e[t]:void 0),e);console.warn("App store. Wrong:",t)}const i=new c,u=new l;function _(e,t,n){n||(i.sound.muted=!1),t&&(i.sound.volume=Number(t)),i.sound.volume>.6?e.className="volume__sound_icon volume-3":i.sound.volume>.3?e.className="volume__sound_icon volume-2":i.sound.volume>0?e.className="volume__sound_icon volume-1":e.className="volume__sound_icon volume-off"}function p(){i.play("dot"),u.set("sound",{volume:i.sound.volume,muted:!1})}function h(){u.set("music",{volume:i.music.volume,muted:!1})}const g=new c;let v=null,f=0;const y=e=>{if(100===e&&v.textContent.includes("loading")&&(v.textContent=""),v&&!g._playing&&!g.music.muted){f+=1,f>3&&(f=1);const e=".".repeat(f-1);v.textContent=`${e}loading${e}`}},E=e=>{v&&(v.textContent=e)},w=()=>{document.querySelector(".volume__music_icon").classList.add("volume-off"),v.textContent=""};class b{static _instance;static _current={ctx:null,pointer:null,hover:null,mode:0};status=null;lang="en";modeUpdateCallback=()=>{};constructor(){if(b._current.ctx||this.prepare(),b._instance)return b._instance;b._instance=this}prepare(){const e=document.querySelector(".game__field");e&&e.getContext&&(b._current.ctx=e.getContext("2d"));const t=document.querySelector(".game__hover");t&&t.getContext&&(b._current.hover=t,b._current.pointer=t.getContext("2d"))}setModeUpdateCallback(e=(()=>{})){this.modeUpdateCallback=e}get ctx(){return b._current.ctx}get mode(){return b._current.mode}set mode(e){const t=b._current.mode;b._current.mode=Number(e),e!==t&&this.modeUpdateCallback()}get pointer(){return b._current.pointer}get hover(){return b._current.hover}}const x=new b;function N(){x.mode=this.value}const k=JSON.parse('[[{"name":"Monkey","data":"0111011111101010111000100"},{"name":"Wrench","data":"0001000111001100100010000"},{"name":"Whell","data":"0111010001101011000101110"},{"name":"Arrow","data":"0011100011001010100010000"},{"name":"Smile","data":"0000001010000001000101110"},{"name":"House","data":"0010001110111110101001110"},{"name":"Barrette","data":"0100011000001000001100010"},{"name":"Sun","data":"1010101110110110111010101"},{"name":"Gear","data":"0010001110110110111000100"},{"name":"Scratches","data":"0100010001001100100010000"},{"name":"Car","data":"0000001110111110101000000"},{"name":"Duck","data":"0011000111110110011000100"},{"name":"Lizard","data":"1010101110001000111010101"},{"name":"Clock","data":"0111011011110011111101110"},{"name":"Diskette","data":"1111011111100011010111111"},{"name":"Alien","data":"1111110101111111111101010"},{"name":"Mouse","data":"0011001111111010111101010"},{"name":"Heart","data":"0101010101100010101000100"},{"name":"Head","data":"0111011111101011111101110"},{"name":"Snail","data":"0110010010101001000101110"},{"name":"Horse","data":"0001100010111101001010010"}],[{"name":"Mail","data":"0000110000000100100000100001000100000010110000001110100001011001001001100011000110000000011111111111"},{"name":"Lamp","data":"0001111000001000010000100001000010000100000111100000000000000001111000000000000000011110000000110000"},{"name":"Key","data":"0000000000000000000000000011100000010001111111000101010100010000001110000000000000000000000000000000"},{"name":"Phone","data":"0000000100001111110000100001000010000100001111110000101011000011010100001010110000110101000011111100"},{"name":"Boobs","data":"0000000000000000000001110011101000110001100000000110100001011000110001011100111000000000000000000000"},{"name":"Boy","data":"0000110000000100100000010010000000110000111111111100111111000001111000000111100000010010000001001000"},{"name":"Bug","data":"0010000100001000010000010010000010110100011000011010100001010010000100000100100000101101000010000100"},{"name":"Ball","data":"0000110000001111110001101111100101111110110111111111111111110111111110011111111000111111000000110000"},{"name":"Vial","data":"0000110000000111100000001100000000110000000111100000111111000111111010111111110111111111110111111110"},{"name":"Copter","data":"0001111111000000100010000111101111100111100000011111110000010000100001000001111000000000000000111111"},{"name":"Scull","data":"0001111000011000011010000000011011001101101100110110010010010100000010010000001001010010100011111100"},{"name":"Smile","data":"0001111000011111111001111111101100000011110011001111111111111101111011011000011001111111100001111000"},{"name":"Booger","data":"0000000000110000001100100001000011111100001011011001111111110111111111001010101000101010100000000000"},{"name":"Duck","data":"0000000000000110000000111100000010110000111111000101111111110001111111000111111000001111000000000000"},{"name":"Bell","data":"0000110000000100100000100001000010000100001000010000111111000100110010100011000101000000100011111100"},{"name":"Coin","data":"0001111000011000011001011110101011111101101111110110111111011011111101010111101001100001100001111000"},{"name":"Cup","data":"0001000000000010000000010000001111111111100000010110000001010100001010001111000011111111000000000000"},{"name":"TV set","data":"0001001000000011000001111111101000000111100000010110000001111000000101100000011111111111110111111110"},{"name":"Dog","data":"0000000000000100000011110000011111111110001111111000111111100010000010011000011000000000000000000000"},{"name":"Cat","data":"0000000000100010000011111000001010100000011100000100100000010111100001011111111011111111100000000000"},{"name":"Bird","data":"0000000000001110000001111000001101100000011111000001111111000111111111011111110001111000000001000000"},{"name":"Skate","data":"0001100000000110000011001000000011111100000011101000001110000000111100000100001111111111000010010000"}],[{"name":"TV set","data":"000100000001000000010000010000000001000100000000000101000000111111111111111111111111111111110000000000111110000000000101110000000000111110000000000101110000000000111110000000000111111111111111111111111111111111000000000000000"},{"name":"Key","data":"000000000000000000000000000000000000000000000000000000000000011111000000000100000100000000100100111111111101110100000001100100111001001100000100110110011111000000000000000000000000000000000000000000000000000000000000000000000"},{"name":"Cart","data":"000000000000000000000000000000000000000000000110000000000000111000000000000000111111111111000100000000001000100000000001000011111111110000010000000010000001000000100000001111111100000000000000000000001100001100000001100001100"},{"name":"Fish","data":"000000000000000000000000000000000000011110000000111111110001001000001100011010000000111101100001000000001100100100000010100000100000010100001000000001100000001111111010000011000001001111111110000000000000000000000000000000000"},{"name":"Lamp","data":"000000111000000000001000100000000011111110000000010000011111110011111110001101100000000101101000000000101100000000000101010000000011101001000000000001000111000111111000001000100000000010000010000000100000001000000111111111000"},{"name":"Cat","data":"111000000000111100100000001001100010000010001100001000100001100001000100001100001111100001100000000000001010000000000010010100000001010100100000001001100000010000001100000111000001100000000000001011000000000110000111111111000"},{"name":"Gemm","data":"000000000000000000000000000000000111111111000001000000000100010000000000010100000000000001101111110000001100111110000001010011110000010001001110000100000100110001000000010010010000000001000100000000000111000000000000000000000"},{"name":"Ham","data":"000111110000000011000001000000010000000100000100110001010000100110001010000100000010010000100000100010000100001000010000010110000010000001000000001000000111111000100000000000100011000000000010001000000000001010000000000001100"},{"name":"Coffee cup","data":"000001111100000000111111111000001110000011100001100000001111001110000011101001001111100101001000000000101011000000000101101000000000110100100000001001100010000010001100001111100001011000000000110000110000011000000001111100000"},{"name":"Ball","data":"000000111000000000011000110000000100000001000001010000000100010010000000010010001000000010100001000000001100000100000001100000010000001010000001100010010000000011010001000000000100000100000001000000011000110000000000111000000"},{"name":"Cube","data":"000111111111110001000000000001010000110000011100000000000101111111111111001100000000001101100000000001101100110011001001100110011001001100000000001011100110011001011100110011001001100000000001010100000000001100011111111111000"},{"name":"Cute","data":"011100000001110111110000011111111111111111111011000000000110010000000000010100000000000001100000000000001100110000011001100110000011001100110000011001100000111000001100000000000001110000000000011111111111111111011111111111110"},{"name":"Lock","data":"000011111110000000100000001000000100000001000000100000001000001111111111100110100000001011101111111111101100000000000001100000000000001100000111000001100000010000001100000010000001100000010000001110000000000011001111111111100"},{"name":"Umbrella","data":"000000010000000000001111100000000111111111000011111111111110111111111111111000000010000000000000010000000000000010000000000000010000000000000010000000000000010000000000000010000000000000010000000000000010100000000000001000000"},{"name":"Mushroom","data":"000000000000000000001111100000000111111111000011100111111110111100111001111111111111001111001111111111100000000111000000000000111000000000000111000000000000111000000000000111000000000000111000000000000111000000000000000000000"},{"name":"Heart","data":"111111111111111111111111111111111111111111111111000111000111110000010000011100000000000001100000000000001100000000000001110000000000011111000000000111111100000001111111110000011111111111000111111111111101111111111111111111111"},{"name":"Bus","data":"000000000000000001111111111100010000000000010100000000000001100000000000001100000000000001100000000000001100000000000001100000000000001111111111111111111001111100111111001111100111111111111111111000110000011000000000000000000"},{"name":"Plain","data":"000000010000000000000111000000000000111000000000000111000000000000111000000000100111001000000100111001000000111111111000011111111111110111111111111111000000111000000000000111000000000000111000000000000111000000000001111100000"},{"name":"Rocket","data":"000000010000000000000111000000000001111100000000001101100000000001111100000000001101100000000001111100000000001111100000000001111100000000011111110000000111111111000000110000011000000100111001000000000111000000000000010000000"},{"name":"World","data":"000001111100000000110000011000001001000000100010000110000010010000001000010100000001000101111100000100101100010000100101100010000101001100100000010001010011110000010010000010000010001000010000100000110100011000000001111100000"},{"name":"Leaf","data":"000000000000001000000000000011000000000011111000000001111101000000111111011000011111110111000111111101110001111111011110001111100111100011111011111000011110111111000001101111110000001111111100000011001110000000110000000000000"},{"name":"Squirrel","data":"000000111000000000001001001100000011001010100000110000010110001100000100011011001111000101010110000010001010100000011111010100011000010010100001111100010000001100000001000011110000000101110011111111100001111111111111111000000"}]]');class L{static _instance;base=[[],[],[]];constructor(){if(L._instance)return L._instance;L._instance=this,this.base=k}blank(e){const t=5*(e+1);return Array.from({length:t},(()=>Array.from({length:t},(()=>0))))}stringify(e){return e.map((e=>e.map((e=>1===e?1:0)))).flat(1).join("")}add(e,t){if(!e||e.length<2)return new Error("Invalid name");if(!t||!Array.isArray(t)&&"string"!=typeof t)return new Error("Invalid puzzle data");const n="string"==typeof t?t:this.stringify(t),a=Math.sqrt(n.length)/5-1;return this.list(a).includes(e)?new Error(`${e} already exist`):(this.base[a].unshift({name:e,data:n}),"Puzzle was saved")}parse(e){const t=Math.sqrt(e.length);return t!==~~t?null:Array.from({length:t},((n,a)=>Array.from({length:t},((n,s)=>Number(e.charAt(a*t+s))))))}get(e,t){if(!this.base[e])return console.warn(`Game mode ${e} not found!`),this.blank(e);if(!this.base[e][t])return console.warn(`Game puzzle ${t} not found!`),this.blank(e);const{name:n,data:a}=this.base[e][t],s=this.parse(a);return s?{name:n,data:s}:(console.warn(`Game puzzle ${n} is corrupted!`),this.blank(e))}list(e){const t=this.base[e];return t?Array.from({length:t.length},((e,n)=>t[n].name)):(console.warn(`Game mode ${e} not found!`),[])}}const S=t.blockSize,z=t.spf,C=e=>{e.ctx.clearRect(0,0,t.size,t.size),e.ctx.strokeStyle=e.color80,e.ctx.beginPath();for(let t=0;t<=e.rows;t+=1)e.ctx.moveTo(e.start+t*S,e.start),e.ctx.lineTo(e.start+t*S,e.start+e.rows*S),e.ctx.moveTo(e.start,e.start+t*S),e.ctx.lineTo(e.start+e.rows*S,e.start+t*S);e.ctx.stroke(),e.ctx.strokeStyle=e.color100,e.ctx.beginPath();for(let t=0;t<=e.rows;t+=5)e.ctx.moveTo(e.start+t*S,e.start),e.ctx.lineTo(e.start+t*S,e.start+e.rows*S),e.ctx.moveTo(e.start,e.start+t*S),e.ctx.lineTo(e.start+e.rows*S,e.start+t*S);e.ctx.stroke()},q=e=>{const t=e.start;for(let n=0;n<e.rows;n+=1)for(let a=0;a<e.rows;a+=1){const s=t+a*S,o=t+n*S;1===e.arr[n][a]&&(e.ctx.fillStyle=e.color100,e.ctx.fillRect(s+1,o+1,S-2,S-2)),2===e.arr[n][a]&&$(e,s,o)}},T=e=>{const t=e.start;for(let n=0;n<e.rows;n+=1)for(let a=0;a<e.rows;a+=1){const s=t+a*S,o=t+n*S;0===e.puzzle[n][a]&&1===e.arr[n][a]&&A(e,s,o),1===e.puzzle[n][a]&&1!==e.arr[n][a]&&(e.ctx.fillStyle="yellow",e.ctx.fillRect(s+1,o+1,S-2,S-2))}},M=(e,n,a)=>{if(e.pointer.clearRect(0,0,t.size,t.size),-1!==n&&-1!==a){const t=e.start,s=t+n*S,o=t+a*S;e.pointer.fillStyle=e.color100,e.pointer.fillRect(s,t,S,e.rows*S),e.pointer.fillRect(t,o,e.rows*S,S)}},$=(e,t,n,a=0)=>{if(e.ctx.clearRect(t+1,n+1,S-2,S-2),2===a)return;const s=S/4;e.ctx.strokeStyle=e.color100,e.ctx.beginPath(),e.ctx.moveTo(t+s,n+s),e.ctx.lineTo(t+S-s,n+S-s),e.ctx.moveTo(t+S-s,n+s),e.ctx.lineTo(t+s,n+S-s),e.ctx.stroke()},A=(e,t,n)=>{e.ctx.clearRect(t+1,n+1,S-2,S-2);const a=S/4;e.ctx.strokeStyle="red",e.ctx.beginPath(),e.ctx.moveTo(t+a,n+a),e.ctx.lineTo(t+S-a,n+S-a),e.ctx.moveTo(t+S-a,n+a),e.ctx.lineTo(t+a,n+S-a),e.ctx.stroke()},R=e=>{e.ctx.font="14px arial",e.ctx.strokeStyle="gray";const t=e.start;for(let n=0;n<e.rows;n+=1){let a=[],s=0;for(let t=0;t<e.rows;t+=1)1===e.puzzle[t][n]?s+=1:s>0&&(a.push(s),s=0);s>0&&a.push(s),a.reverse().forEach(((a,s)=>{const o=t+n*S+(S-14)/2;e.ctx.strokeText(a,o,t-S/2-17*s)}))}for(let n=0;n<e.rows;n+=1){let a=[],s=0;for(let t=0;t<e.rows;t+=1)1===e.puzzle[n][t]?s+=1:s>0&&(a.push(s),s=0);s>0&&a.push(s),a.reverse().forEach(((a,s)=>{const o=t+n*S+(S-14)/2+14;e.ctx.strokeText(a,t-S/2-7-17*s,o)}))}},G=JSON.parse('{"en":{"reset":["Yep! Let\'s clear this field.","Clearing field also resets your turns."],"solution":["Using solution make you impossible to score this puzzle.","It is solution option. Using it prevent you to score your result!"],"save":["Want to save this game?","Wanna save your state?","Saves current game."],"blank-filed":["...this field is still empty.","There is still nothing in the field."],"adequateName":"...consider to use adequate name for a new puzzle.","duplicateName":["This name is already used.","Come up with something new."],"editorNew":["Let\'s create own puzzle!","Show your creative skills!","OK, let\'s get creative."],"gameNew":["Wanna play?","OK, let\'s do this!","Time to solve this puzzle!","What we have here?","It will be easy!","Ready for action?","Let\'s solve this puzzle!"],"attemtsHalf":["Used half of maximum turns!","Keep track of the attempts used."],"unknown":["What are you trying to do?","What are you trying to achieve with this?","Hm-m-m... What?"],"noSavedGame":["No saved games.","Need to save something first.","No saved records."],"lastGameRecovered":["Recovered last attempt.","Welcome back!","We have uncomplete task here."]},"ru":{"reset":["Да! Давай очистим.","Очистка поля также сбрасывает ходы."],"solution":["Активация подсказки сделает невозможным завершить головоломку.","Показать решение? Использование не позволит продолжить!"],"save":["Сохранить эту игру?","Сохранить текущее состояние?","Сохраняет текущую игру."],"blank-filed":["...это поле все еще пусто.","На поле ещё ничего нет."],"adequateName":"...стоит придумать адекватное название для новой головоломки.","duulateName":["Это имя уже используется.","Придумай что-нибудь новое."],"editorNew":["Давай создадим собственную головоломку!","Прояви творческие способности!","Давай проявим творческий подход."],"gameNew":["Хочешь сыграть?","Ладно, давай сделаем это!","Время решить эту головоломку!","Что у нас здесь?","Это будет легко!","Готов к действию?","Давай разгадаем эту головоломку!"],"attemtsHalf":["Использована половина максимального количества ходов!","Следи за использованными ходами."],"unknown":["Что ты пытаешься сделать?","Чего ты пытаешься этим добиться?","Хм-м-м... Чего?"],"noSavedGame":["Нет сохраненных игр.","Сначала нужно что-то сохранить.","Нет сохраненных записей."],"lastGameRecovered":["Восстановлена последняя попытка.","С возвращением!","У нас есть невыполненная задача."]}}'),P=new b,O={shrike:null,bulldog:null},H=(e,t=null,n=3e3)=>{const a=P.lang,s=document.querySelector(`.speech__${e}`);if(!t)return void s.classList.add("hidden");if(!G[a]||!G[a][t])throw new Error("No such message");const o=G[a][t],c=Array.isArray(o)?o[~~(Math.random()*o.length)]:o;s.textContent=c,s.classList.remove("hidden"),clearTimeout(O[e]),O[e]=setTimeout((()=>s.classList.add("hidden")),n)},D=JSON.parse('{"en":{"newGame":"New game","randomGame":"Random","loadGame":"Load game","editor":"Editor","records":"Records","about":"About","startNewGame":"Start new game","selectPuzzle":"Select puzzle","preview":"Preview","start":"Start","win":"Win!","loose":"Loose!","timeUsed":"Time","turnsUsed":"Turns","score":"Total score","solutionUsed":"solution used","puzzleName":"Puzzle name","save":"Save","turnsOut":"Your turns is out.","timeOut":"Your time is out.","recordsTitle":"Game records:","aboutTitle":"About:","description":[["In this game your goal is to solve nonograms with Shrike and Bulldog.","Nonograms is a picture logic puzzles in which cells in a grid must be colored or left blank according to numbers at the edges of the grid to reveal a hidden picture."],["### Characters:","Shrike: Have ability to instantly solve current puzzle.","Bulldog: Able to clear field and reset turns count."],["### How to solve:","In this puzzle, the numbers are a form of discrete tomography that measures how many unbroken lines of filled-in squares there are in any given row or column. For example, a clue of \\"4 8 3\\" would mean there are sets of four, eight, and three filled squares, in that order, with at least one blank square between successive sets."],["### Author:","Game was developed by [mrHoft](https://github.com/mrHoft) in 2024 as an educational project of [RSSchool](https://rs.school/) Front-end-s1 course.","Inspirated by [Zeurel](https://www.youtube.com/@Zeurel) \\"[Monkey Wrench](https://www.youtube.com/@MonkeyWrenchSeries)\\".","No TypeScript, React or any other library used (by task rules): only core JS, only hardcore!"]]},"ru":{"newGame":"Новая игра","randomGame":"Случайная","loadGame":"Загрузить","editor":"Редактор","records":"Рекорды","about":"Об игре","startNewGame":"Начать игру","selectPuzzle":"Выбор пазла","preview":"Картинка","start":"Начать","win":"Победа!","loose":"Поражение!","timeUsed":"Время","turnsUsed":"Ходы","score":"Всего набрано","solutionUsed":"использована подсказка","puzzleName":"Название","save":"Сохранить","turnsOut":"Закончились ходы.","timeOut":"Закончилось время.","recordsTitle":"Рекорды:","aboutTitle":"Об игре:","description":[["Суть игры в решении нонограм вместе со Шрайком и Буллдогом.","Нонограммы это логическая игра - пазл, в которой нужно закрасить клетки в соответствии с цифрами на полях чтобы получить скрытую картинку."],["### Персонажи:","Шрайк: Обладает способностью мгновенно решить пазл.","Буллдог: Может очистить поле и сбросить счётчик ходов."],["### Как решать пазлы:","В этой головоломке числа показывают сколько непрерывных линий заполненных ячеек имеется в любой строке или столбце. Например, подсказка «4 8 3» будет означать, что существуют наборы из четырех, восьми и трех заполненных ячеек в этом порядке, и по крайней мере с одниой пустой ячейкой между ними."],["### Автор:","Игру создал [mrHoft](https://github.com/mrHoft) в 2024 году в рамках образовательного проекта курса [RSSchool](https://rs.school/) Front-end-s1.","Вдохновлено анимационным сериалом \\"[Monkey Wrench](https://www.youtube.com/@MonkeyWrenchSeries)\\" от [Zeurel](https://www.youtube.com/@Zeurel).","Не использованы ни TypeScript, ни React или какие-либо вообще библиотеки (по условиям задачи): только core JS, только хардкор!"]]}}'),U=new c,I=(e,n,a)=>new Promise((s=>{let o=n;!function n(){if(o+=Math.max(2*~~((a-o)/10),1),e.textContent=o,U.use("step"),o>=a)return s();setTimeout(n,2*t.spf)}()})),W=e=>`${("0"+~~(e/60)).slice(-2)}:${("0"+e%60).slice(-2)}`,B=new L,F=new c,V=new l,j=t.blockSize,K={};let J=null;const Y={current:{mode:0,puzzle:0,solution:0,turns:0},init:{events:!1,base:!1,editor:!1},pointer:null,field:{el:null,size:600,k:1},start:0,rows:0,c:{x:-1,y:-1,down:-1},stats:{pos:null,turns:null,progress:null},arr:[],puzzle:[],puzzleName:null,pointsTotal:0,turnsMax:0,timer:0,time:0,status:null},Z=()=>{const t=new e;Y.color00=t.color00,Y.color50=t.color50,Y.color80=t.color80,Y.color90=t.color90,Y.color100=t.color100},X=()=>{Z();const e=new b;Y.ctx=e.ctx,Y.pointer=e.pointer,Y.mode=e.mode;const n=~~(t.size/2);Y.rows=5*(e.mode+1);const a=Y.rows%2?j/2:0,s="game"===Y.status&&15===Y.rows?j:0;Y.start=n-Math.floor(Y.rows/2)*j-a+s,Y.stats.pos=document.querySelector(".stats__pos"),Y.stats.turns=document.querySelector(".stats__turns"),Y.stats.progress=document.querySelector(".stats__progress_bar"),Y.stats.progress.removeAttribute("style"),Y.field.el=e.hover,Y.field.size=t.size20deg,Y.arr=B.blank(Y.mode),Y.stats.progress.removeAttribute("style"),document.querySelector(".game__solution").removeAttribute("style")},Q=(e,n)=>{Y.status="end",document.querySelector(".base").classList.add("disabled"),Y.c.down=-1,M(Y,-1,-1),clearInterval(Y.timer);const a=~~((new Date-Y.time)/1e3),s=5*Math.max(3*Y.pointsTotal-a,0),o=5*Math.max(Y.turnsMax-Y.current.turns,0);if((async({time:e,turns:n,score:a,msg:s="win",solution:o=!1,descr:c=null})=>{const r=(new b).lang,{timeScore:l,turnsScore:d}=a;U.say(s);const m=document.querySelector(".modal__reslt");var i,u;m.classList.add("disabled"),m.classList.remove("hidden"),m.reslt.solution.classList.remove("visible"),m.reslt.score.removeAttribute("style"),m.reslt.shrike.classList.toggle("loose","win"!==s),m.reslt.title.textContent=D[r][s],m.reslt.descr.textContent=c?D[r][c]:"",m.reslt.score.textContent="0",await(i=m.reslt.time,u=e,new Promise((e=>{let n=0;!function a(){n+=Math.max(2*~~((u-n)/10),1);const s=~~(n/60),o=n%60;if(i.textContent=`${("0"+s).slice(-2)}:${("0"+o).slice(-2)}`,U.use("step"),n>=u)return e();setTimeout(a,2*t.spf)}()}))),await I(m.reslt.score,0,l),await new Promise((e=>setTimeout((()=>e()),500))),await I(m.reslt.turns,0,n),await I(m.reslt.score,l,l+d),"win"===s&&o&&m.reslt.solution.classList.add("visible"),(o||"win"!==s)&&(m.reslt.score.style.textDecoration="line-through"),m.classList.remove("disabled")})({time:a,turns:Y.current.turns,score:{timeScore:s,turnsScore:o},msg:e,solution:Y.current.solution,descr:n}),"win"!==e&&setTimeout((()=>T(Y)),t.spf*j/4),"win"===e){const e={name:Y.puzzleName,mode:Y.current.mode,time:a,turns:Y.current.turns,solution:Y.current.solution,score:Y.current.solution?0:s+o,date:new Date},t=V.get("records");let n=!0;if(Array.isArray(t))for(let a=0;a<t.length;a+=1)if(t[a].name===Y.puzzleName){V.set(`records.${a}`,e),n=!1;break}n&&V.add("records",e)}V.set("last.game",null)},ee=()=>{if(Y.time){const e=document.querySelector(".stats__timer"),t=~~((new Date-Y.time)/1e3);e.textContent=W(t)}},te=()=>{V.set("last.game",{...Y.current,time:~~((new Date-Y.time)/1e3),arr:B.stringify(Y.arr)})},ne=()=>{if("end"===Y.status)return;const e=Y.c.x,t=Y.c.y;if(-1!==e&&-1!==t){Y.time||(Y.time=new Date);const n=Y.arr[t][e],a=Y.start,s=a+e*j,o=a+t*j;0===Y.c.down&&(Y.arr[t][e]=1===n?0:1,((e,t,n,a)=>{let s=a*(S-4);const o=()=>{e.ctx.clearRect(t+1,n+1,S-2,S-2),e.ctx.fillStyle=e.color100,e.ctx.fillRect(t+S/2-s/2,n+S/2-s/2,s,s),s+=a?-4:4,s>0&&s<S?setTimeout(o,z):1!==a?e.ctx.fillRect(t+1,n+1,S-2,S-2):e.ctx.clearRect(t+1,n+1,S-2,S-2)};o()})(Y,s,o,2===n?0:n),1===Y.arr[t][e]&&F.use("dot"),Y.current.turns+=1,"game"===Y.status&&((e,t)=>{let n=0;for(let t=0;t<Y.rows;t+=1)Y.puzzle[t][e]===(1===Y.arr[t][e]?1:0)&&(n+=1);let a=0;for(let e=0;e<Y.rows;e+=1)Y.puzzle[t][e]===(1===Y.arr[t][e]?1:0)&&(a+=1);n&&console.log("Matched: ",e),((e,t,n)=>{e.ctx.font="14px arial",e.ctx.strokeStyle=n?"yellow":"gray";const a=e.start;e.ctx.clearRect(a+t*S,a-1,S,4*-S);let s=[],o=0;for(let n=0;n<e.rows;n+=1)1===e.puzzle[n][t]?o+=1:o>0&&(s.push(o),o=0);o>0&&s.push(o),s.reverse().forEach(((n,s)=>{const o=a+t*S+(S-14)/2;e.ctx.strokeText(n,o,a-S/2-17*s)}))})(Y,e,n===Y.rows),((e,t,n)=>{e.ctx.font="14px arial",e.ctx.strokeStyle=n?"yellow":"gray";const a=e.start;e.ctx.clearRect(a-1,a+t*S,4*-S,S);let s=[],o=0;for(let n=0;n<e.rows;n+=1)1===e.puzzle[t][n]?o+=1:o>0&&(s.push(o),o=0);o>0&&s.push(o),s.reverse().forEach(((n,s)=>{const o=a+t*S+(S-14)/2+14;e.ctx.strokeText(n,a-S/2-7-17*s,o)}))})(Y,t,a===Y.rows)})(e,t),"game"===Y.status&&(()=>{if("game"!==Y.status)return;Y.stats.turns.textContent=`${Y.current.turns}/${Y.turnsMax}`,Y.current.turns===~~(Y.turnsMax/2)&&H("shrike","attemtsHalf");let e=0,t=0;for(let n=0;n<Y.rows;n+=1)for(let a=0;a<Y.rows;a+=1)1===Y.puzzle[n][a]?1===Y.arr[n][a]&&(e+=1,t+=1):1===Y.arr[n][a]&&(e-=1,t+=1);e=Math.max(e,0),Y.stats.progress.style.width=~~(100*Math.min(t/Y.pointsTotal,1))+"%",Y.current.turns>Y.turnsMax?Q("loose","turnsOut"):e===Y.pointsTotal&&Q("win")})(),"editor"===Y.status&&V.set("last.editor",{mode:Y.current.mode,arr:B.stringify(Y.arr)})),2===Y.c.down&&(Y.arr[t][e]=2===n?0:2,$(Y,s,o,n),2===Y.arr[t][e]&&F.use("cross"))}},ae=e=>{const t=Math.floor((e.offsetX/Y.field.k-Y.start)/j),n=Math.floor((e.offsetY/Y.field.k-Y.start)/j);t>=0&&n>=0&&t<Y.rows&&n<Y.rows?t===Y.c.x&&n===Y.c.y||(Y.c.x=t,Y.c.y=n,M(Y,t,n),Y.stats.pos.textContent=`${t+1}:${n+1}`,-1!=Y.c.down?ne():F.use("step")):(-1===Y.c.x&&-1===Y.c.y||(M(Y,-1,-1),Y.stats.pos.textContent="0:0"),Y.c.x=-1,Y.c.y=-1)},se=()=>{const e=!window.matchMedia("(max-width: 720px)").matches,t=document.querySelector(".game");t.classList.add("disabled");const n=()=>{"game"!==Y.status&&"end"!==Y.status||R(Y),t.classList.remove("flip2"),t.classList.remove("disabled")};e?(t.classList.add("flip1"),setTimeout((()=>{Y.arr=B.blank(Y.mode),C(Y),t.classList.remove("flip1"),t.classList.add("flip2"),setTimeout(n,300)}),300)):(t.classList.add("flip0"),setTimeout((()=>{Y.arr=B.blank(Y.mode),C(Y),"game"!==Y.status&&"end"!==Y.status||R(Y),t.classList.remove("flip0"),t.classList.remove("disabled")}),300)),F.use("whoosh"),Y.current.turns=0,Y.stats.turns.textContent=`${Y.current.turns}/${Y.turnsMax}`,"editor"===Y.status&&V.set("last.editor",null)},oe=()=>{const e=~~Y.field.el.getBoundingClientRect().width;e!==Y.field.size&&(Y.field.size=e,Y.field.k=e>=723?1:e/t.size)},ce=e=>{if(e){if(e.preventDefault(),0===Y.arr.flat().reduce(((e,t)=>e+t),0))return void H("bulldog","blank-filed");const t=new FormData(e.target).get("name");if(t.length<3||t.length>18)return void H("shrike","adequateName");if(B.list(Y.current.mode).includes(t))return void H("shrike","duplicateName");const n=B.stringify(Y.arr);console.log(n);const a=B.add(t,Y.arr),s=document.querySelector(".editor__save_message");s.textContent=a,s.classList.remove("hidden"),s.style.animation="none",s.offsetHeight,s.style.animation=null,a instanceof Error||(xe(),V.add("puzzles",{name:t,puzzle:n}),V.set("last.editor",null))}},re=()=>{window.addEventListener("resize",oe),oe();const t=new b;t.hover.addEventListener("mousemove",ae),t.hover.addEventListener("mousedown",(e=>{e.preventDefault(),Y.c.down=e.button,ne()})),t.hover.addEventListener("mouseup",(e=>{e.preventDefault(),Y.c.down=-1})),document.querySelector(".game").addEventListener("contextmenu",(e=>e.preventDefault())),document.querySelector(".editor__save_form").addEventListener("submit",ce),(new e).addCallback((()=>{Z(),C(Y),q(Y),"game"!==Y.status&&"end"!==Y.status||R(Y)}));const n=document.querySelector(".game__reset");n.addEventListener("click",se),n.addEventListener("mouseleave",(()=>J=null)),n.addEventListener("mouseenter",(e=>{J=e.target;const t=e.target.classList[0];K[t]&&clearTimeout(K[t]),K[t]=setTimeout((()=>{if(J===e.target){const e=Y.arr.flat().reduce(((e,t)=>e+t),0);H("bulldog",e>0?"reset":"blank-filed")}}),250)}));const a=document.querySelector(".game__solution");a.addEventListener("mouseleave",(()=>J=null)),a.addEventListener("mouseenter",(e=>{J=e.target;const t=e.target.classList[0];K[t]&&clearTimeout(K[t]),K[t]=setTimeout((()=>{J===e.target&&H("shrike","solution",4e3)}),250)})),a.addEventListener("click",(()=>{Y.current.solution+=1,T(Y),a.style.backgroundColor="#800b",Y.time=0,document.querySelector(".game").classList.add("disabled")}));const s=document.querySelector(".game__save");s.addEventListener("click",te),s.addEventListener("mouseleave",(()=>J=null)),s.addEventListener("mouseenter",(e=>{J=e.target;const t=e.target.classList[0];K[t]&&clearTimeout(K[t]),K[t]=setTimeout((()=>{J===e.target&&H("bulldog","save")}),250)})),Y.init.events=!0},le=e=>{console.log("Start editor"),document.querySelector(".game").classList.remove("disabled");const t=e?null:V.get("last.editor");Y.status="editor";const n=new b;n.setModeUpdateCallback((()=>{})),t?n.mode=t.mode??2:Y.init.editor||(n.mode=2),Y.current.mode=n.mode,clearInterval(Y.timer),X(),C(Y),Y.init.events||re(),Y.init.editor=!0,n.setModeUpdateCallback((()=>le(!0))),document.querySelector(".base").classList.remove("disabled"),document.querySelector(".editor__mode").classList.remove("hidden"),document.querySelector(".editor__save_form").classList.remove("hidden"),document.querySelector(".game__solution").classList.add("hidden"),document.querySelector(".game__save").classList.add("hidden"),document.querySelector(".game__header_text").classList.add("hidden"),document.querySelector(".stats__progress").classList.add("hidden"),document.querySelector(".stats__turns").classList.add("hidden"),document.querySelectorAll(".editor__mode_select")[n.mode].checked=!0,t&&(Y.arr=B.parse(t.arr),q(Y),document.querySelector(".editor__save_name-text").value=t.name??""),H(Math.random()>.5?"bulldog":"shrike","editorNew")},de=(e,t,n)=>{void 0===e&&(e=~~(3*Math.random())),void 0===t&&(t=~~(Math.random()*B.list(e).length)),console.log(`Start game: ${e}-${t}${n?" (recovered)":""}`),document.querySelector(".game").classList.remove("disabled"),Y.status="game";const a=new b;a.setModeUpdateCallback(),a.mode=e,X();const{name:s,data:o}=B.get(e,t);Y.puzzle=o,Y.puzzleName=s,Y.current={mode:e,puzzle:t,solution:0,turns:0};const c=o.flat().reduce(((e,t)=>e+t),0);Y.pointsTotal=c,Y.turnsMax=3*c,Y.stats.turns.textContent=`${Y.current.turns}/${Y.turnsMax}`,Y.init.events||re(),Y.init.start=!0,document.querySelector(".base").classList.remove("disabled"),document.querySelector(".editor__mode").classList.add("hidden"),document.querySelector(".editor__save_form").classList.add("hidden"),document.querySelector(".game__solution").classList.remove("hidden"),document.querySelector(".game__save").classList.remove("hidden"),document.querySelector(".stats__progress").classList.remove("hidden"),document.querySelector(".stats__turns").classList.remove("hidden");const r=document.querySelector(".game__header_text");r.classList.remove("hidden"),r.textContent=s,document.querySelector(".stats__timer").textContent="00:00",Y.time=0,clearInterval(Y.timer),Y.timer=setInterval(ee,1e3),C(Y),R(Y),n&&n.time+10<10*Y.pointsTotal&&(Y.arr=B.parse(n.arr),Y.current.solution=n.solution,Y.current.turns=n.turns,Y.time=new Date-1e3*n.time,n.solution&&(document.querySelector(".game__solution").style.backgroundColor="#800b"),q(Y)),H(Math.random()>.5?"bulldog":"shrike",n?"lastGameRecovered":"gameNew")},me=new l,ie=new l,ue=new c,_e=new L;let pe=0,he=0;const ge=()=>{ue.use("slide"),document.querySelector(".modal__game").classList.remove("hidden"),document.querySelector(".modal__game_btn").classList.add("disabled"),document.querySelector(".modal__puzzle_select").value="",xe()},ve=()=>{document.querySelector(".modal__game").classList.add("hidden"),de(pe,he)},fe=()=>{document.querySelector(".modal__game").classList.add("hidden"),de()},ye=()=>{const e=ie.get("last.game");e?de(e.mode,e.puzzle,e):H("bulldog","noSavedGame")},Ee=()=>{const e=new b;"editor"!==e.status?(e.mode=2,le()):H("bulldog","unknown")},we=()=>{ue.use("slide"),document.querySelector(".modal__records").classList.remove("hidden"),(()=>{const e=me.get("records"),t=document.querySelector(".modal__records_list");t.innerHTML="",e.sort(((e,t)=>parseInt(new Date(t.date).getTime()-new Date(e.date).getTime()))).slice(0,5).forEach((e=>{const n=document.createElement("li");n.className="modal__records_item";const a=document.createElement("span");a.textContent=(e=>{const t=new Date(e),n=t.getFullYear().toString().slice(-2),a=`0${t.getMonth()+1}`.slice(-2);return`${`0${t.getDate()}`.slice(-2)}.${a}.${n} ${`0${t.getHours()}`.slice(-2)}:${`${t.getMinutes()}`.slice(-2)}`})(e.date);const s=document.createElement("span");s.textContent=e.name;const o=document.createElement("span");o.textContent=W(e.time);const c=document.createElement("span");c.textContent=e.turns;const r=document.createElement("span");r.textContent=e.score,n.append(a,s,o,c,r),t.append(n)}))})()},be=()=>{ue.use("slide"),document.querySelector(".modal__about").classList.remove("hidden")},xe=()=>{const e=_e.list(pe),t=document.querySelector(".modal__puzzle_select"),n=ie.get("records");t.innerHTML="",e.forEach(((e,a)=>{let s=n.some((t=>t.mode===pe&&t.score>0&&t.name===e));const o=document.createElement("option");o.value=a,o.textContent=`${a<9?` ${a+1}`:a+1}. ${e}${s?" ✔":""}`,t.append(o)}))},Ne=e=>{document.querySelector(".modal__game_btn").classList.remove("disabled"),he=Number(e.currentTarget.value),ue.use("step"),ke()},ke=()=>{const t=new e,n=document.querySelector(".modal__puzzle_preview").getContext("2d"),a=_e.get(pe,he).data,s=15/(pe+1),o=a.length;n.clearRect(0,0,75,75),n.fillStyle=t.color100;for(let e=0;e<o;e+=1)for(let t=0;t<o;t+=1)a[e][t]&&n.fillRect(t*s,e*s,s,s)},Le=e=>{new b,pe=Number(e.target.value),ue.use("step"),xe()},Se=e=>{e.target===e.currentTarget&&e.target.classList.add("hidden")},ze=()=>{const e=(new b).lang,t=document.createElement("div");t.className="menu__side";const n=document.createElement("div");n.className="menu__side_right";const a=document.createElement("nav");a.className="menu__side_nav";const s=document.createElement("ul");return s.className="menu__list",["newGame","randomGame","loadGame","editor","records","about"].forEach((t=>{const n=t.match(/^[a-z]+/)[0],a=document.createElement("li");a.className="menu__list_item",a.addEventListener("mouseenter",(()=>ue.use("step")));const o=document.createElement("div");o.className="hex-btn";const c=document.createElement("div"),r=document.createElement("div");r.className=`icon_${n}`,c.append(r),o.append(c),a.append(document.createTextNode(D[e][t]),o),s.append(a)})),a.append(s),t.append(n,a),t},Ce=()=>{const t=(new e).name;document.querySelectorAll(".modal__close_icon").forEach((e=>e.classList.toggle("invert","dark"===t))),document.querySelector(".game__reset_icon").classList.toggle("invert","dark"===t),document.querySelector(".game__save_icon").classList.toggle("invert","dark"===t),document.querySelector(".rss__logo").classList.toggle("invert","dark"!==t),document.querySelector(".volume__sound_icon").classList.toggle("invert","dark"!==t),document.querySelector(".volume__music_icon").classList.toggle("invert","dark"!==t),document.querySelector(".bg").classList.toggle("bright","dark"!==t),document.querySelector(".icon_new").classList.toggle("invert","dark"===t),document.querySelector(".icon_random").classList.toggle("invert","dark"===t),document.querySelector(".icon_load").classList.toggle("invert","dark"===t),document.querySelector(".icon_editor").classList.toggle("invert","dark"===t),document.querySelector(".icon_records").classList.toggle("invert","dark"===t),document.querySelector(".icon_about").classList.toggle("invert","dark"===t)},qe=new e,Te=new l,Me=new b;let $e=2;function Ae(){const e=document.createElement("main");e.className="main";const n=document.createElement("div");n.className="base",n.append(function(){const e=document.createElement("div");e.className="game";const n=document.createElement("canvas");n.className="game__field",n.width=t.size,n.height=t.size,n.textContent="Game field";const a=document.createElement("canvas");a.className="game__hover",a.width=t.size,a.height=t.size;const s=document.createElement("div");s.className="game__reset hex-btn";const o=document.createElement("div"),c=document.createElement("div");c.className="game__reset_icon",o.append(c),s.append(o);const r=document.createElement("div");r.className="game__solution hex-btn";const l=document.createElement("div");l.textContent="!",r.append(l);const d=document.createElement("div");d.className="game__save hex-btn";const m=document.createElement("div"),i=document.createElement("div");i.className="game__save_icon",m.append(i),d.append(m);const u=document.createElement("div");u.className="game__header";const _=document.createElement("p");_.className="game__header_text hidden",u.append(_,function(){const e=document.createElement("div");return e.className="editor__mode mode hidden",t.modes.forEach(((t,n)=>{const a=document.createElement("input");a.className="editor__mode_select mode-select",a.type="radio",a.value=n,a.name="e_mode",a.id=`e_mode${n}`,a.addEventListener("change",N);const s=document.createElement("label");s.textContent=t,s.htmlFor=`e_mode${n}`,e.append(a,s)})),e}());const p=document.createElement("div");p.className="game__left";const h=document.createElement("div");h.className="game__right";const g=document.createElement("div");g.className="game__top";const v=document.createElement("div");return v.className="game__bott",e.append(u,n,a,p,h,g,v,s,r,d,function(){const e=document.createElement("div");e.className="game__stats";const t=document.createElement("span");t.className="stats__turns",t.textContent="0/0";const n=document.createElement("span");n.className="stats__pos",n.textContent="0:0";const a=document.createElement("div");a.className="stats__progress";const s=document.createElement("p");s.className="stats__timer",s.textContent="00:00";const o=document.createElement("div");o.className="stats__progress_wrap";const c=document.createElement("div");return c.className="stats__progress_bar",o.append(c),a.append(s,o),e.append(t,a,n),e}(),function(){const e=Me.lang,t=document.createElement("form");t.className="editor__save_form hidden";const n=document.createElement("div");n.className="editor__save_name";const a=document.createElement("input");a.name="name",a.type="text",a.autocomplete="off",a.placeholder="",a.className="editor__save_name-text";const s=document.createElement("label");s.className="editor__save_name-label",s.textContent=D[e].puzzleName,n.append(a,s);const o=document.createElement("button");o.type="submit",o.className="editor__save_btn button",o.textContent=D[e].save;const c=document.createElement("div");return c.className="editor__save_message hidden",t.append(n,o,c),t}()),e}());const a=document.createElement("div");return a.className="bg",e.append(a,ze(),function(){const e=document.createElement("div");e.className="player__audio";const t=document.createElement("p");return t.className="player__title",v=t,g.readyCallback=y,g.startPlayCallback=E,g.exceptionCallback=w,e.append(function(){const e=u.get("sound"),t=u.get("music");e&&(Number.isFinite(e.volume)&&(i.sound.volume=e.volume),"boolean"==typeof e.muted&&(i.sound.muted=e.muted)),t&&(Number.isFinite(t.volume)&&(i.music.volume=t.volume),"boolean"==typeof t.muted&&(i.music.muted=t.muted));const n=document.createElement("div");n.className="volume";const a=document.createElement("div");a.className="volume__sound";const s=document.createElement("div");s.className="volume__sound_icon";const o=document.createElement("input");o.className="volume__range",o.type="range",o.step="0.05",o.value=i.sound.volume,o.max="1",o.addEventListener("input",(()=>_(s,o.value))),o.addEventListener("mouseup",p),s.addEventListener("click",(()=>{return e=s,i.sound.muted=!i.sound.muted,i.sound.muted?e.className="volume__sound_icon volume-off":_(e),void u.set("sound.muted",i.sound.muted);var e})),a.append(s,o);const c=document.createElement("div");c.className="volume__music";const r=document.createElement("div");r.className="volume__music_icon";const l=document.createElement("input");return l.className="volume__range",l.type="range",l.step="0.05",l.value=i.music.volume,l.max="1",l.addEventListener("input",(()=>{return e=r,t=l.value,i.music.muted&&(i.musicMuted=!1),t&&(i.musicVolume=Number(t)),void e.classList.toggle("volume-off",0===i.music.volume);var e,t})),l.addEventListener("mouseup",h),r.addEventListener("click",(()=>{return e=r,i.musicMuted=!i.music.muted,e.classList.toggle("volume-off",i.music.muted),void u.set("music.muted",i.music.muted);var e})),c.append(r,l),n.append(a,c),_(s,i.sound.volume,!0),i.sound.muted&&(s.className="volume__sound_icon volume-off"),r.classList.toggle("volume-off",0===i.music.volume||i.music.muted),n}(),v),e}(),n,function(){const e=document.createElement("div");e.className="chars";const t=document.createElement("div");t.className="chars__shrike";const n=document.createElement("div");n.className="chars__bulldog";const a=document.createElement("blockquote");a.className="speech__shrike hidden",t.append(a);const s=document.createElement("blockquote");return s.className="speech__bulldog hidden",n.append(s),e.append(t,n),e}()),e}function Re(e,t=(()=>{})){const n=document.createElement(e);n.className=e;const a=new XMLHttpRequest;return a.onreadystatechange=function(){4===this.readyState&&(200===this.status&&(n.innerHTML=this.responseText,$e-=1,$e<=0&&t()),404===this.status&&(n.innerHTML="Page not found."))},a.open("GET",`./template/${e}.tmpl`,!0),a.send(),n}const Ge=new c,Pe=new L,Oe=new l;(function(){const e=Te.get("lang");Me.lang=e??"en",console.log("lanuage:",e);const n=Te.get("theme");document.body.classList.toggle("theme__dark","dark"===n);const a=e=>{qe.color00=getComputedStyle(document.body).getPropertyValue("--color00"),qe.color50=getComputedStyle(document.body).getPropertyValue("--color50"),qe.color80=getComputedStyle(document.body).getPropertyValue("--color80"),qe.color90=getComputedStyle(document.body).getPropertyValue("--color90"),qe.color100=getComputedStyle(document.body).getPropertyValue("--color100"),qe.name=e},s=()=>{(()=>{const e=document.querySelector(".theme__switcher");e.checked="dark"===n,a(n),e.addEventListener("change",(e=>{e.preventDefault();const t=e.currentTarget.checked;document.body.classList.toggle("theme__dark",t),a(t?"dark":"light"),Te.set("theme",t?"dark":"light"),Ce()}))})(),Ce(),(()=>{const t=document.querySelector(".language__icon"),n=document.querySelector(".language__select");n.value=e,t.className=`language__icon ${e}`,n.addEventListener("change",(e=>{e.preventDefault(),Te.set("lang",e.target.value),location.replace("/")}))})()};document.body.append(Re("header",s),Ae(),Re("footer",s),(()=>{const e=(new b).lang,n=document.createElement("div");n.className="modal__game hidden";const a=document.createElement("div");a.className="modal__inner";const s=document.createElement("div");s.className="modal__left";const o=document.createElement("div");o.className="modal__right";const c=document.createElement("div");c.className="modal__bott";const r=document.createElement("div");r.className="modal__close hex-btn";const l=document.createElement("div"),d=document.createElement("div");d.className="modal__close_icon",l.append(d),r.append(l),r.addEventListener("click",(()=>n.classList.add("hidden")));const m=document.createElement("h2");m.className="modal__title",m.textContent=D[e].startNewGame;const i=document.createElement("div");i.className="modal__buttons";const u=document.createElement("div");u.className="modal__game_btn button",u.textContent=D[e].start,u.addEventListener("click",ve);const _=document.createElement("div");return _.className="button",_.textContent=D[e].randomGame,_.addEventListener("click",fe),i.append(u,_),a.append(s,o,c,r,m,function(){const e=document.createElement("div");return e.className="modal__mode mode",t.modes.forEach(((t,n)=>{const a=document.createElement("input");a.className="modal__mode_select mode-select",a.type="radio",a.value=n,a.name="m_mode",a.id=`m_mode${n}`,a.addEventListener("change",Le);const s=document.createElement("label");s.textContent=t,s.htmlFor=`m_mode${n}`,e.append(a,s)})),e}(),function(){const e=(new b).lang,t=document.createElement("div");t.className="modal__puzzle";const n=document.createElement("div");n.className="modal__puzzle_left";const a=document.createElement("span");a.textContent=D[e].selectPuzzle;const s=document.createElement("div");s.className="modal__scroll_wrap";const o=document.createElement("select");o.className="modal__puzzle_select scrolled",o.size=10,o.addEventListener("click",Ne),s.append(o),n.append(a,s);const c=document.createElement("div");c.className="modal__puzzle_right";const r=document.createElement("span");r.textContent=D[e].preview;const l=document.createElement("div");l.className="modal__puzzle_preview-wrap";const d=document.createElement("canvas");return d.className="modal__puzzle_preview",d.width=75,d.height=75,d.textContent="Preview field",l.append(d),c.append(r,l),t.append(n,c),t}(),i),n.append(a),n.addEventListener("click",Se),n})(),(()=>{const e=(new b).lang,t=document.createElement("div");t.className="modal__reslt hidden";const n=document.createElement("div");n.className="modal__inner";const a=document.createElement("div");a.className="modal__left";const s=document.createElement("div");s.className="modal__right";const o=document.createElement("div");o.className="modal__bott";const c=document.createElement("div");c.className="modal__close hex-btn";const r=document.createElement("div"),l=document.createElement("div");l.className="modal__close_icon",r.append(l),c.append(r),c.addEventListener("click",(()=>t.classList.add("hidden")));const d=document.createElement("h2");d.className="modal__title",d.textContent=D[e].win;const m=document.createElement("p");m.className="modal__reslt_descr";const i=document.createElement("p");i.className="modal__reslt_descr";const u=document.createElement("span");u.className="modal__time",u.textContent="00:00",i.append(document.createTextNode(`${D[e].timeUsed}:`),u);const _=document.createElement("p");_.className="modal__reslt_descr";const p=document.createElement("span");p.className="modal__turns",p.textContent="0",_.append(document.createTextNode(`${D[e].turnsUsed}:`),p);const h=document.createElement("p");h.className="modal__reslt_descr";const g=document.createElement("span");g.className="modal__score",g.textContent="0",h.append(document.createTextNode(`${D[e].score}:`),g);const v=document.createElement("div");v.className="modal__solution",v.textContent=`(${D[e].solutionUsed})`;const f=document.createElement("div");f.className="modal__reslt_shrike";const y=document.createElement("div");return y.className="button",y.textContent="OK",y.addEventListener("click",(()=>t.classList.add("hidden"))),n.append(a,s,o,c,d,m,i,_,h,v,f,y),t.reslt={title:d,descr:m,time:u,turns:p,score:g,shrike:f,solution:v},t.append(n),t.addEventListener("click",Se),t})(),(()=>{const e=(new b).lang,t=document.createElement("div");t.className="modal__records hidden";const n=document.createElement("div");n.className="modal__inner";const a=document.createElement("div");a.className="modal__left";const s=document.createElement("div");s.className="modal__right";const o=document.createElement("div");o.className="modal__bott";const c=document.createElement("div");c.className="modal__close hex-btn";const r=document.createElement("div"),l=document.createElement("div");l.className="modal__close_icon",r.append(l),c.append(r),c.addEventListener("click",(()=>t.classList.add("hidden")));const d=document.createElement("h2");d.className="modal__title",d.textContent=D[e].recordsTitle;const m=document.createElement("div");m.className="modal__scroll_wrap";const i=document.createElement("ul");i.className="modal__records_list scrolled",m.append(i);const u=document.createElement("div");return u.className="button",u.textContent="OK",u.addEventListener("click",(()=>t.classList.add("hidden"))),n.append(a,s,o,c,d,m,u),t.append(n),t.addEventListener("click",(e=>{e.target===e.currentTarget&&e.target.classList.add("hidden")})),t})(),(()=>{const e=(new b).lang,t=document.createElement("div");t.className="modal__about hidden";const n=document.createElement("div");n.className="modal__inner";const a=document.createElement("div");a.className="modal__left";const s=document.createElement("div");s.className="modal__right";const o=document.createElement("div");o.className="modal__close hex-btn";const c=document.createElement("div"),r=document.createElement("div");r.className="modal__close_icon",c.append(r),o.append(c),o.addEventListener("click",(()=>t.classList.add("hidden")));const l=document.createElement("h2");l.className="modal__title",l.textContent=D[e].aboutTitle;const d=document.createElement("div");d.className="modal__scroll_wrap";const m=document.createElement("div");m.className="modal__about_descr scrolled",d.append(m),D[e].description.forEach(((e,t)=>{const n=document.createElement("article"),a=document.createElement("div"),s=document.createElement("div");s.className=`modal__about_img0${t+1}`,e.forEach((e=>a.append(function(e){if(e.startsWith("### ")){const t=document.createElement("h3");return t.textContent=e.substring(4),t}const t=function(e){const t=[];return function e(n){const a=n.match(/\[([\w\s\d]+)\]\((https?:\/\/[\w\d./?=#@]+)\)/);if(a){const s=a[1],o=a[2];t.push({text:n.slice(0,a.index),id:s,url:o}),e(n.substring(a.index+s.length+o.length+4))}else t.length&&t.push({text:n})}(e),t.length?t:null}(e);if(t){const e=document.createElement("p");return t.forEach((({text:t,id:n,url:a})=>{if(e.append(document.createTextNode(t)),n){const t=document.createElement("a");t.href=a,t.textContent=n,e.append(t)}})),e}const n=document.createElement("p");return n.textContent=e,n}(e)))),n.append(a,s),m.append(n)}));const i=document.createElement("div");i.className="button",i.textContent="OK",i.addEventListener("click",(()=>t.classList.add("hidden"))),n.append(a,s,o,l,d,i);const u=document.createElement("div");return u.className="modal__bott",t.append(u,n),t.addEventListener("click",(e=>{e.target===e.currentTarget&&e.target.classList.add("hidden")})),t})()),(()=>{const e=new b,t=(e.lang,document.querySelectorAll(".menu__list_item"));t[0].addEventListener("click",ge),t[1].addEventListener("click",fe),t[2].addEventListener("click",ye),t[3].addEventListener("click",Ee),t[4].addEventListener("click",we),t[5].addEventListener("click",be),pe=e.mode,document.querySelectorAll(".modal__mode_select")[pe].checked=!0})()})(),window.addEventListener("load",(function(){const e=Oe.get("puzzles");e&&e.length>0&&e.forEach((e=>Pe.add(e.name,e.puzzle))),de(0),Ge.play(0,1)}))}},e=>{e(e.s=7)}]);